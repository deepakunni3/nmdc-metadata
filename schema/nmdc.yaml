id: https://microbiomedata/schema
name: NMDC Schema
description: >-
  Schema for National Microbiome Data Collaborative (NMDC).
  This schem is organized into 3 separate modules:
    
  * a set of core types for representing data values
  * the mixs schema (auto-translated from mixs excel)
  * the NMDC schema itself
  
license: https://creativecommons.org/publicdomain/zero/1.0/
version: 0.1.1

prefixes:
  nmdc: https://microbiomedata/meta/
  GOLD: https://identifiers.org/gold/
  mixs: https://w3id.org/gensc/
  wgs: http://www.w3.org/2003/01/geo/wgs84_pos
  qud: http://qudt.org/1.1/schema/qudt#
  dcterms: http://purl.org/dc/terms/
  biolinkml: https://w3id.org/biolink/biolinkml/
  
default_prefix: nmdc
default_range: string

default_curi_maps:
  - obo_context
  - idot_context

emit_prefixes:
  - rdf
  - rdfs
  - xsd
  - skos

# This file organizes the main NMDC schema.
# It brings in the mixs schema plus a schemaa
# of core types
imports:
  - biolinkml:types
  - mixs
  - core
  - prov
  
classes:

  database:
    aliases:
      - "NMDC metadata object"
    description: >-
      An abstract holder for any set of metadata and data. It does not need to correspond to an actual managed databse
      top level holder class. When translated to JSON-Schema this is the 'root' object.
      It should contain pointers to other objects of interest
    slots:
      - biosample set
      - study set
      - data object set
      - activity set
      - omics processing set
  
  data object:
    is_a: named thing
    description: >-
      An object that primarily consists of symbols that represent information.  
      Files, records, and omics data are examples of data objects. 
    slots:
      - file size bytes
      - md5 checksum
      - data object type
      - compression type
      - was generated by
    slot_usage:
      was generated by:
        description: >-
          the activity that generated the file
        range: workflow execution activity
        inlined: true
    id_prefixes:
      - GOLD

  workflow execution activity:
    is_a: activity
    description: >-
      Represents an instance of an execution of a particular workflow
    slots:
      - execution resource
      - git url
      - has input
      - has output

  metagenome assembly:
    is_a: workflow execution activity
    slots:
      - asm_score
      - scaffolds
      - scaf_logsum
      - scaf_powsum
      - scaf_max
      - scaf_bp
      - scaf_N50
      - scaf_N90
      - scaf_L50
      - scaf_L90
      - scaf_n_gt50K
      - scaf_l_gt50K
      - scaf_pct_gt50K
      - contigs
      - contig_bp
      - ctg_N50
      - ctg_L50
      - ctg_N90
      - ctg_L90
      - ctg_logsum
      - ctg_powsum
      - ctg_max
      - gap_pct
      - gc_std
      - gc_avg
      - num_input_reads
      - num_aligned_reads


  metagenome annotation activity:
    is_a: workflow execution activity

  read QC analysis activity:
    is_a: workflow execution activity
    slots:
      - input read count
      - input base count
      - output read count
      - output base count

  metabolomics analysis activity:
    is_a: workflow execution activity

  metaproteomics analysis activity:
    is_a: workflow execution activity
      
  biosample:
    is_a: named thing
    aliases: ['sample', 'material sample']
    description: >-
      A material sample. It may be environmental (encompassing many organisms) or isolate or tissue.  
      An environmental sample containing genetic material from multiple individuals is commonly referred to as a biosample.
    slots:
      # any mixs slot can be added here
      - env_package
      - lat_lon
      - geo_loc_name
      - collection_date
      - env_broad_scale
      - env_local_scale
      - env_medium
      - ecosystem
      - ecosystem_category
      - ecosystem_type
      - ecosystem_subtype
      - specific_ecosystem
      - depth
      - tot_org_carb
      - alt
      - elev
      - salinity
      - diss_oxygen
      - geo_loc_name
      - nitrate
      - chlorophyll
      - cur_land_use
      - cur_vegetation
      - cur_vegetation_meth
      - previous_land_use
      - previous_land_use_meth
      - crop_rotation
      - agrochem_addition
      - tillage
      - fire
      - flooding
      - extreme_event
      - horizon
      - horizon_meth
      - sieving
      - water_content
      - water_content_soil_meth
      - samp_vol_we_dna_ext
      - pool_dna_extracts
      - store_cond
      - link_climate_info
      - season_temp
      - annual_temp
      - season_precpt
      - annual_precpt
      - link_class_info
      - fao_class
      - local_class
      - local_class_meth
      - soil_type
      - soil_type_meth
      - slope_gradient
      - slope_aspect
      - profile_position
      - drainage_class
      - texture
      - texture_meth
      - ph_meth
      - tot_org_carb
      - tot_org_c_meth
      - tot_nitro_content
      - tot_nitro_content_meth
      - microbial_biomass
      - microbial_biomass_meth
      - link_addit_analys
      - salinity_meth
      - heavy_metals
      - heavy_metals_meth
      - al_sat
      - al_sat_meth
      - misc_param
    slot_usage:
      id:
        description: >-
          The primary identifier for the biosample. Example: GOLD:Gb0205609
      name:
        description: >-
          A human readable name or description of the biosample
      alternate identifiers:
        description: >-
          The same biosample may have distinct identifiers in different databases (e.g. GOLD and EMSL)
      lat_lon:
        required: true
        description: >-
          This is currently a required field but it's not clear if this should be required for human hosts
      depth:
        required: false
      env_broad_scale:
        required: true
        description: >-
          formerly known as 'biome'
      env_local_scale:
        required: true
        description: >-
          formerly known as 'feature'
      env_medium:
        required: true
        description: >-
          formerly known as 'material'
    id_prefixes:
      - GOLD

        
  study:
    is_a: named thing
    aliases: ['proposal', 'research proposal', 'research study', 'investigation']
    description: >-
      A study summarizes the overall goal of a research initiative and outlines the key objective of its underlying projects.  
    slots:
      #- submitted_to_insdc
      #- investigation_type
      #- project_name
      #- experimental_factor
      - ecosystem
      - ecosystem_category
      - ecosystem_type
      - ecosystem_subtype
      - specific_ecosystem
      - principal investigator
      - doi
    todos:
      - determine how to get data values for submitted_to_insdc, investigation_type, experimental_factor
      - project_name is redundant with name, so excluding it
      
        
    slot_usage:
      id:
        description: >-
          The primary identifier for the study.
      name:
        description: >-
          A human readable name or description of the study.
      alternate identifiers:
        description: >-
          The same study may have distinct identifiers in different databases (e.g. GOLD and EMSL)

  biosample processing:
    is_a: named thing
    description: >-
      A process that takes one or more biosamples as inputs and generates one or as outputs.
      Examples of outputs include samples cultivated from another sample or data objects created by instruments runs.
    slots:
      - has input
    slot_usage:
      has input:
        range: biosample

  omics processing:
    is_a: biosample processing
    description: >-
      The methods and processes used to generate omics data from a biosample or organism.
    comments:
      - The IDs for objects coming from GOLD will have prefixes gold:GpNNNN
    slots:
      - part of
      - has output
      - omics type
    slot_usage:
      id:
        description: >-
          The primary identifier for the omics processing. E.g. GOLD:GpNNNN
      name:
        description: >-
          A human readable name or description of the omics processing.
      alternate identifiers:
        description: >-
          The same omics processing may have distinct identifiers in different databases (e.g. GOLD and EMSL, as well as NCBI)
      part of:
        range: study
      has output:
        range: data object

  person:
    is_a: named thing
    description: >-
      represents a person, such as a researcher
    comments:
      - "not yet in use"
    slot_usage:
      id:
        description: >-
          Should be an ORCID. Specify in CURIE format. E.g ORCID:0000-1111-...
    

slots:

  biosample set:
    domain: database
    range: biosample
    multivalued: true
    inlined: true
    description: >-
      This property links a database object to the set of samples within it.

  study set:
    domain: database
    range: study
    multivalued: true
    inlined: true
    description: >-
      This property links a database object to the set of studies within it.

  data object set:
    domain: database
    range: data object
    multivalued: true
    inlined: true
    description: >-
      This property links a database object to the set of data objects within it.
  
  activity set:
    domain: database
    range: activity
    multivalued: true
    inlined: true
    description: >-
      This property links a database object to the set of prov activities.
  
  omics processing set:
    domain: database
    range: omics processing
    multivalued: true
    inlined: true
    description: >-
      This property links a database object to the set of omics processings within it.

  omics type:
    range: controlled term value
    description: >-
      The type of omics data
    examples:
      - value: metatranscriptome
      - value: metagenome
      
  data object type:
    range: controlled term value
    description: >-
      The type of data object
    examples:
      - value: metagenome_assembly
      
  compression type:
    range: string
    description: >-
      If provided, specifies the compression type
    examples:
      - value: gzip
    todos:
      - consider enum
      
  has input:
    aliases: ['input']
    # range: named thing
    multivalued: true
    description: >-
      An input to a process.
    
  has output:
    aliases: ['output']
    #domain: named thing
    #range: named thing
    multivalued: true
    description: >-
      An output biosample to a processing step

  part of:
    aliases: ['is part of']
    domain: named thing
    multivalued: true
    slot_uri: dcterms:isPartOf
    description: >-
      Links a resource to another resource that either logically or physically includes it.

  ## DATA

  execution resource:
    is_a: attribute
    description: >-
      Example: NERSC-Cori
      
  git url:
    is_a: attribute
    range: string
    description: >-
      Example: https://github.com/microbiomedata/mg_annotation/releases/tag/0.1
      
  file size bytes:
    is_a: attribute
    range: bytes
    description: >-
      Size of the file in bytes
  
  md5 checksum:
    is_a: attribute
    range: string
    description: >-
      MD5 checksum of file (pre-compressed)

  ## Workflow specific

  metagenome assembly parameter: {}

  asm_score:
    is_a: metagenome assembly parameter
      
  n_scaffolds:
    is_a: metagenome assembly parameter

  scaffolds:
    is_a: metagenome assembly parameter

  scaf_logsum:
    is_a: metagenome assembly parameter

  scaf_powsum:
    is_a: metagenome assembly parameter

  scaf_max:
    is_a: metagenome assembly parameter
      
  scaf_bp:
    is_a: metagenome assembly parameter

  scaf_N50:
    is_a: metagenome assembly parameter
      
  scaf_N90:
    is_a: metagenome assembly parameter

  scaf_L50:
    is_a: metagenome assembly parameter

  scaf_L90:
    is_a: metagenome assembly parameter

  scaf_n_gt50K:
    is_a: metagenome assembly parameter

  scaf_l_gt50K:
    is_a: metagenome assembly parameter      

  scaf_pct_gt50K:
    is_a: metagenome assembly parameter
      
  contigs:
    is_a: metagenome assembly parameter

  contig_bp:
    is_a: metagenome assembly parameter
      
  ctg_N50:
    is_a: metagenome assembly parameter

  ctg_L50:
    is_a: metagenome assembly parameter

  ctg_N90:
    is_a: metagenome assembly parameter

  ctg_L90:
    is_a: metagenome assembly parameter     

  ctg_logsum:
    is_a: metagenome assembly parameter

  ctg_powsum:
    is_a: metagenome assembly parameter

  ctg_max:
    is_a: metagenome assembly parameter
      
  gap_pct:
    is_a: metagenome assembly parameter
      
  gc_std:
    is_a: metagenome assembly parameter

  gc_avg:
    is_a: metagenome assembly parameter

  num_input_reads:
    is_a: metagenome assembly parameter    

  num_aligned_reads:
    is_a: metagenome assembly parameter
      
  read QC analysis statistic: {}

  input read count:
    is_a: read QC analysis statistic

  input base count:
    is_a: read QC analysis statistic

  output read count:
    is_a: read QC analysis statistic

  output base count:
    is_a: read QC analysis statistic
    
  ## GOLD SPECIFIC

  principal investigator:
    aliases:
      - PI
      - principal investigator
    is_a: attribute
    range: person value
    description: >-
      represents the PI

  doi:
    is_a: attribute
    range: attribute value
    
  ## GOLD PATHS

  gold_path_field:
    is_a: attribute
    range: attribute value
    abstract: true
    description: >-
      This is a grouping for any of the gold path fields
    
  ecosystem:
    is_a: gold_path_field
    description: >-
      TODO
  ecosystem_category:
    is_a: gold_path_field
    description: >-
      TODO
  ecosystem_type:
    is_a: gold_path_field
    description: >-
      TODO
  ecosystem_subtype:
    is_a: gold_path_field
    description: >-
      TODO
  specific_ecosystem:
    is_a: gold_path_field
    description: >-
      TODO
